# 사용자 인지 경로 정리 서비스 (Project Requirements Document)

## 1. 프로젝트 개요
**사용자 인지 경로 정리** 서비스는 엑셀 파일로 업로드된 고객의 인지 경로 데이터를 사전 정의된 기준에 따라 자동으로 분류하고 집계하여 간소화된 보고서 형태로 제공하는 웹 애플리케이션입니다.

- **목표**: 일관되지 않은 사용자 입력 데이터를 표준화된 카테고리로 매핑하고, 광고 유입 등 특정 항목에 대한 상세 분석 기능을 제공하여 마케팅 데이터 정리를 자동화합니다.
- **주요 가치**: 데이터 전처리 시간 단축, 인지 경로별 정확한 통계 산출.

## 2. 주요 기능

### 2.1 엑셀 파일 업로드 및 분석
- **파일 선택**: `.xlsx`, `.xls` 형식의 엑셀 파일 업로드 지원.
- **데이터 파싱**: 첫 번째 시트를 자동으로 읽어오며, 헤더 유무를 자동으로 감지하여 데이터 행을 식별.
- **자동 매핑**:
  - **정확 일치**: 사전 정의된 키워드와 정확히 일치하는 경우 매핑.
  - **키워드 포함**: 특정 키워드가 포함된 경우 해당 카테고리로 매핑.
  - **광고 처리**: '광고' 관련 키워드 포함 시 '광고 합계'에 합산함과 동시에, 세부 광고 매체(예: 인스타그램, 유튜브 등)별로도 별도 항목 생성 (이중 집계).
  - **미매핑 유지**: 매핑 기준에 없으면 원본 텍스트 그대로 유지.

### 2.2 분석 결과 확인
- **결과 목록**: 매핑된 '매체 및 경로'와 해당 경로로 유입된 '회원수'를 테이블 형태로 표시.
- **총계 표시**: 광고 상세 항목의 중복 합산을 제외한 실제 총 유입 회원수를 상단에 계산하여 표시.
- **정렬**: 사전 정의된 우선순위(Sort Order)에 따라 중요 경로 순으로 정렬.

### 2.3 결과 다운로드
- **엑셀 다운로드**: 분석된 결과(테이블 내용)를 새로운 엑셀 파일(`path.xlsx`)로 다운로드 제공.
- **서식 적용**: 컬럼 너비 등 기본 스타일이 적용된 상태로 생성.

## 3. 기술 스택
- **Runtime**: Node.js (v20 이상 권장 - User environment dependent) (v20+ recommended)
- **Framework**: React 19 (Vite)
- **Language**: TypeScript
- **Styling**: Vanilla CSS (Global Styles), CSS Modules (implicitly supported by Vite)
- **Libraries**:
  - `xlsx`: 엑셀 파일 읽기 및 쓰기.
- **Build Tool**: Vite (Swift HMR & Bundling)

## 4. 데이터 처리 로직 (Mapping Logic)

### 4.1 매핑 프로세스 (`src/utils/processor.ts`)
데이터는 다음 순서로 우선순위를 가집니다.

1.  **빈 값 체크**: 빈 문자열은 "미입력"으로 처리.
2.  **광고 특수 처리**:
    - "광고" 또는 "(광고)" 문자열 포함 시:
        - `광고 합계` 카테고리 카운트 증가 (Total Aggregation).
        - 원본 텍스트(또는 정규화된 이름)를 상세 항목으로 유지하여 카운트 증가 (Detail Tracking).
        - 즉, 하나의 엑셀 행이 두 개의 결과 행(합계 + 상세)에 기여.
3.  **정확 일치 (Exact Match)**:
    - `EXACT_MATCH_CRITERIA` 목록에 있는 경우 해당 명칭 그대로 사용.
4.  **키워드 매핑 (Keyword Mapping)**:
    - `KEYWORD_MAPPING` 목록을 순회하며 포함된 단어가 있는지 확인.
    - 발견 시 해당 `target`으로 매핑.
5.  **기타 (Default)**:
    - 위 조건에 맞지 않는 경우 원본 텍스트 유지.

### 4.2 기준 데이터 (`src/data/criteria.ts`)
- **EXACT_MATCH_CRITERIA**: 정확히 일치해야 하는 우선 항목들 (예: "깨봉 유튜브 채널", "AIQ" 등).
- **KEYWORD_MAPPING**: 포함 시 변환할 키워드 맵 (예: "지인" -> "지인소개", "IG" -> "깨봉 인스타그램").
- **SORT_ORDER**: 결과 출력 시 정렬 순서 정의.

## 5. 폴더 구조
```
src/
├── components/       # UI 컴포넌트 (FileUpload 등)
├── data/             # 매핑 기준 및 설정 데이터 (criteria.ts)
├── utils/            # 핵심 로직 (processor.ts - 엑셀 처리 및 매핑)
├── App.tsx           # 메인 페이지 및 상태 관리
└── index.css         # 전역 스타일
```

## 6. 버전 히스토리
- **v1.0**: 초기 엑셀 매핑 및 집계 로직 구현 완료.
