# 구현 계획서: 엑셀 데이터 정비 웹 서비스

## 목표
사용자가 업로드한 엑셀 파일의 경로(A열) 데이터를 분석하여 지정된 기준 항목으로 매핑하고, 회원수(B열)를 집계하여 새로운 엑셀 파일로 출력하는 웹 서비스를 구축한다.

## 사용자 리뷰 필요 사항
- **기준 항목 매핑 규칙**: 제공된 텍스트 기반 매핑 규칙을 적용합니다. 모호한 경우(예: 중복 키워드) 우선순위가 필요할 수 있습니다. 현재는 목록 상위/명시된 순서를 우선으로 처리할 예정입니다.
- **예외 처리**: 매핑되지 않는 항목은 **원본 항목의 이름과 데이터를 그대로 출력**합니다.

## 제안된 변경 사항

### 프로젝트 구조 및 설정 [NEW]
- **Framework**: Vite + React + TypeScript
- **Styling**: Vanilla CSS (Black Theme)
- **Library**: `xlsx` (SheetJS) for Excel processing
- **Path**: `d:/SynologyDrive/dev_projects/customer-awareness-path`

### UI/UX 디자인
- **테마**: 전체적으로 검정 배경(Dark Mode) 및 가독성 높은 텍스트 사용 (User Rule: 블랙 테마)
- **레이아웃**:
    - **Header**: 서비스 제목 **"사용자 인지 경로 정리"**
    - **Criteria List**: 현재 적용된 기준 항목 표시 (사이드바 또는 모달/토글)
    - **Action Area**: 파일 업로드 버튼 (**드래그앤드롭 제외**)
    - **Result Area**: 변환 결과 미리보기 (Table), 엑셀 다운로드 버튼

### 데이터 처리 로직 (Core Logic)
`src/utils/excelProcessor.ts` (예정)
1. **입력**: 엑셀 파일 로드 (A열: Path, B열: Count)
2. **매핑 (Mapping)**: 각 행의 Path 문자열에 대해 다음 키워드 검사 (순차적용):
    - "지인" -> "지인소개"
    - "커뮤니티" -> "커뮤니티(맘카페 등)"
    - "깨봉 인스타그램", "IG" -> "깨봉 인스타그램"
    - "기사" -> "언론기사"
    - "카카오 라이브 쇼핑" -> "카쇼라"
    - "네이버 라이브 쇼핑" -> "네쇼라"
    - "커넥터즈" -> "커넥터즈"
    - "(광고)" 포함 -> "광고 합계" (세부 항목도 별도 집계 필요? 요구사항엔 "광고 합계" 항목과 세부 항목들이 나열됨. 아마도 개별 매핑 후 "광고 합계"는 뷰에서 합산해서 보여주거나, 엑셀에는 개별 항목으로 나가고 합계 행이 추가되는 식일 수 있음. -> 요구사항: "광고 합계: ... 포함 항목의 합계", 그리고 그 아래 "(광고)..." 항목들이 있음. 
    *해석*: "(광고)"가 들어간 것은 각각의 광고 항목(예: (광고)라디오)으로도 분류되고, "광고 합계"라는 별도 항목으로도 묶여야 함? 아니면 그냥 "(광고)..." 항목들은 다 "광고 합계"로 퉁치고, 아래 리스트는 그냥 참고용?
    *재확인*: 요구사항 리스트에 "광고 합계"와 "(광고)라디오" 등이 병렬로 있음. 이는 **결과 엑셀**에 이 모든 행이 존재해야 한다는 의미로 보임. 즉, "(광고)라디오" 데이터는 "(광고)라디오" 행에도 집계되고, "광고 합계" 행에도 포함되어야 할 수도 있음. 하지만 통상적으로는 Mapping target이 Unique해야 함. 
    *가설*: 입력 데이터에 "(광고)라디오..." 라고 적혀 있으면 -> "(광고)라디오" 항목으로 매핑. 그리고 나중에 뷰/엑셀에서 "광고 합계"를 낼 수도 있음. 일단 1:1 매핑을 원칙으로 하되 리스트에 있는 항목들을 Target으로 잡음.
    - 빈칸 -> "미입력"
    - 그 외 정확한 일치(Exact Match): 깨봉 유튜브 채널, AIQ, 제휴, TV방송, 도서, 강연, 깨봉 네이버 블로그, 페이스북, 간식퀴즈, 수학페스티벌, 단원평가 PDF, 직접입력
    - **매핑되지 않은 항목**: 원본 Path 문자열을 그대로 기준 항목으로 사용 (User Feedback 적용)
3. **집계 (Aggregation)**: 매핑된 기준 항목별 B열(회원수) 합산
4. **출력**: `[기준 항목, 총 회원수]` 형태의 엑셀 생성

### 파일 구조
#### [New] src
- `App.tsx`: 메인 UI
- `components/FileUpload.tsx`: 파일 업로드 컴포넌트
- `components/ResultTable.tsx`: 결과 표시 컴포넌트
- `utils/processor.ts`: 엑셀 처리 로직
- `data/criteria.ts`: 기준 항목 정의

## 검증 계획

### 자동화 테스트
- 단위 테스트는 설정하지 않으나, 로직 검증을 위한 간단한 스크립트 실행 가능.
- `processor.ts`의 매핑 로직에 대해 샘플 문자열을 넣고 예상된 기준 항목이 나오는지 콘솔 로그로 확인.

### 수동 검증
1. `npm run dev`로 로컬 서버 실행.
2. `docs/회원_가입_인지_경로_2026_01_05.xlsx` 파일 업로드.
3. 화면에 표시된 집계 결과가 원본 데이터의 내용과 일치하는지 샘플링 검사.
   - 예: "지인에게 추천" -> "지인소개"로 분류되었는지 확인.
   - 예: "(광고)인스타그램" -> "(광고)인스타그램"으로 분류되었는지 확인.
4. "엑셀 다운로드" 버튼 클릭 후 다운로드된 파일 열기.
5. A열(기준 항목), B열(수치) 확인.
6. 블랙 테마 적용 여부 시각적 확인.

